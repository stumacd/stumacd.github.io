---
layout: post
title: Ruby on rails 3 - rvm, bundle, eeeekk
date: '2010-08-01T01:28:00.000-07:00'
tags:
- ror
- mysql
- ruby on rails
- rvm
- rails 3
modified_time: '2010-09-28T14:07:40.000-07:00'
blogger_id: tag:blogger.com,1999:blog-4711902727427506568.post-3436289239779463562
blogger_orig_url: http://toastedtoothpaste.blogspot.com/2010/08/ruby-on-rails-3-rvm-bundle-eeeekk.html
---

<span style="font-family:georgia;">Having a freshly loaded Ubuntu 10.04 on my main desktop (after checking it out for months on my laptop), I thought I'd get ruby on rails set up. After setting up Rails 2 with the minimum of fuss, I took the challenge of upgrading to Rails 3 (release candidate).</span><br /><br /><a style="font-family: georgia;" href="http://rvm.beginrescueend.com/">RVM</a><span style="font-family:georgia;"> is now an essential component of any rails environment, letting you change between rails version in an instant (Theoretically, but more on that soon).</span><br /><br /><span style="font-family:georgia;">Installing it was as simple as:</span><br /><span style="font-family:georgia;"> $ bash < <( curl http://rvm.beginrescueend.com/releases/rvm-install-head )</span><br /><br /><span style="font-family:georgia;">After installing all the necessary </span><a style="font-family: georgia;" href="http://rvm.beginrescueend.com/os/ubuntu/">ubuntu packages</a><br /><br /><span style="font-family:georgia;"> $ rvm install 1.9.2-rc2</span><br /><span style="font-family:georgia;"> $ </span><code style="font-family: georgia;">rvm 1.9.2-rc2</code><br /><span style="font-family:georgia;"> $ </span><code style="font-family: georgia;">gem install rails --pre</code><br /><br /><span style="font-family:georgia;">I can't seem to switch between rubies as I would like, but I'm sure I can solve this soon.</span><br /><br /><span style="font-family:georgia;">To start a new project we have to forget the rails 2 ways and start with:</span><br /><code style="font-family: georgia;"><br />$ rails new test</code><code style="font-family: georgia;">_project<br /><br />You should see the usual files (plus a few new ones) being created.<br /><br />$ cd test_project<br /></code><span style="font-family:georgia;"> $ bundle install</span><br /><br /><span style="font-family:georgia;">This is where I had some problems with mysql. I had installed every possible mysql package but it stll wasn't working.</span><br /><br /><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >Using activeresource (3.0.0.rc) </span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >Using bundler (1.0.0.rc.1) </span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >Installing mysql (2.8.1) with native extensions /usr/local/lib/site_ruby/1.8/rubygems/installer.rb:483:in `build_extensions': ERROR: Failed to build gem native extension. (Gem::Installer::ExtensionBuildError)</span><span style="font-size:85%;"><br /><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >/usr/bin/ruby1.8 extconf.rb </span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >checking for mysql_query() in -lmysqlclient... no</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >checking for main() in -lm... yes</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >checking for mysql_query() in -lmysqlclient... no</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >checking for main() in -lz... yes</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >checking for mysql_query() in -lmysqlclient... no</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >checking for main() in -lsocket... no</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >checking for mysql_query() in -lmysqlclient... no</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >checking for main() in -lnsl... yes</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >checking for mysql_query() in -lmysqlclient... no</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >checking for main() in -lmygcc... no</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >checking for mysql_query() in -lmysqlclient... no</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >*** extconf.rb failed ***</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >Could not create Makefile due to some reason, probably lack of</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >necessary libraries and/or headers.  Check the mkmf.log file for more</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >details.  You may need configuration options.</span><span style="font-size:85%;"><br /><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >Provided configuration options:</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --with-opt-dir</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --without-opt-dir</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --with-opt-include</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --without-opt-include=${opt-dir}/include</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --with-opt-lib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --without-opt-lib=${opt-dir}/lib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --with-make-prog</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --without-make-prog</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --srcdir=.</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --curdir</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --ruby=/usr/bin/ruby1.8</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --with-mysql-config</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --without-mysql-config</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --with-mysql-dir</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --without-mysql-dir</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --with-mysql-include</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --without-mysql-include=${mysql-dir}/include</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --with-mysql-lib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --without-mysql-lib=${mysql-dir}/lib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --with-mysqlclientlib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --without-mysqlclientlib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --with-mlib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --without-mlib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --with-mysqlclientlib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --without-mysqlclientlib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --with-zlib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --without-zlib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --with-mysqlclientlib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --without-mysqlclientlib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --with-socketlib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --without-socketlib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --with-mysqlclientlib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --without-mysqlclientlib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --with-nsllib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --without-nsllib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --with-mysqlclientlib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --without-mysqlclientlib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --with-mygcclib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --without-mygcclib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --with-mysqlclientlib</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    --without-mysqlclientlib</span><span style="font-size:85%;"><br /><br /><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >Gem files will remain installed in /home/stumacd/RoR/projects/wiki/ruby/1.8/gems/mysql-2.8.1 for inspection.</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >Results logged to /home/stumacd/RoR/projects/wiki/ruby/1.8/gems/mysql-2.8.1/ext/mysql_api/gem_make.out</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    from /usr/local/lib/site_ruby/1.8/rubygems/installer.rb:446:in `each'</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    from /usr/local/lib/site_ruby/1.8/rubygems/installer.rb:446:in `build_extensions'</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    from /usr/local/lib/site_ruby/1.8/rubygems/installer.rb:198:in `install'</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    from /usr/lib/ruby/gems/1.8/gems/bundler-1.0.0.rc.1/lib/bundler/source.rb:96:in `install'</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    from /usr/lib/ruby/gems/1.8/gems/bundler-1.0.0.rc.1/lib/bundler/installer.rb:51:in `run'</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    from /usr/lib/ruby/gems/1.8/gems/bundler-1.0.0.rc.1/lib/bundler/spec_set.rb:12:in `each'</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    from /usr/lib/ruby/gems/1.8/gems/bundler-1.0.0.rc.1/lib/bundler/spec_set.rb:12:in `each'</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    from /usr/lib/ruby/gems/1.8/gems/bundler-1.0.0.rc.1/lib/bundler/installer.rb:40:in `run'</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    from /usr/lib/ruby/gems/1.8/gems/bundler-1.0.0.rc.1/lib/bundler/installer.rb:8:in `install'</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    from /usr/lib/ruby/gems/1.8/gems/bundler-1.0.0.rc.1/lib/bundler/cli.rb:115:in `install'</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    from /usr/lib/ruby/gems/1.8/gems/bundler-1.0.0.rc.1/lib/bundler/vendor/thor/task.rb:22:in `send'</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    from /usr/lib/ruby/gems/1.8/gems/bundler-1.0.0.rc.1/lib/bundler/vendor/thor/task.rb:22:in `run'</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    from /usr/lib/ruby/gems/1.8/gems/bundler-1.0.0.rc.1/lib/bundler/vendor/thor/invocation.rb:109</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    from /usr/lib/ruby/gems/1.8/gems/bundler-1.0.0.rc.1/lib/bundler/vendor/thor/invocation.rb:116:in `call'</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    from /usr/lib/ruby/gems/1.8/gems/bundler-1.0.0.rc.1/lib/bundler/vendor/thor/invocation.rb:116:in `invoke'</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    from /usr/lib/ruby/gems/1.8/gems/bundler-1.0.0.rc.1/lib/bundler/vendor/thor.rb:161:in `start'</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    from /usr/lib/ruby/gems/1.8/gems/bundler-1.0.0.rc.1/lib/bundler/vendor/thor/base.rb:379:in `start'</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    from /usr/lib/ruby/gems/1.8/gems/bundler-1.0.0.rc.1/lib/bundler/vendor/thor.rb:140:in `start'</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    from /usr/lib/ruby/gems/1.8/gems/bundler-1.0.0.rc.1/bin/bundle:13</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    from /usr/bin/bundle:19:in `load'</span><span style="font-size:85%;"><br /></span><span style="font-family: courier new;font-family:georgia;font-size:85%;"  >    from /usr/bin/bundle:19</span><br /><br /><span style="font-family:georgia;">The trick was to install it with the correct parameters (found by using $ which mysql)</span><br /><br /><span style="font-family:georgia;"> <span style="font-size:130%;"><span style="font-weight: bold;">$ gem install mysql -- --with-mysql-conf=/usr/bin/mysql --with-mysql-lib=/usr/lib/mysql</span></span></span><br /><br /><span style="font-family:georgia;">This allowed all the applicable gems to be installed.</span><br /><br /><span style="font-family:georgia;">And now with a:</span><br /><br /><span style="font-family:georgia;"> $ rails server</span><br /><br /><span style="font-family:georgia;">WEBrick was up and running and http://localhost:3000 was showing the standard page.</span> Gold dust :)
